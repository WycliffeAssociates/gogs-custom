{{template "base/head" .}}
<div class="repository file edit">
	{{template "repo/header" .}}
	<div class="ui container">
		{{.branchName}}
		{{template "base/alert" .}}
		<form class="ui form" action="{{EscapePound $.Link}}" method="post">
			{{.CsrfTokenHtml}}
			<div class="ui secondary menu">
				<div class="item fitted">
					<div class="ui breadcrumb field{{if .Err_Filename}} error{{end}}">
						<a class="section" href="{{EscapePound $.BranchLink}}">{{.Repository.Name}}</a>
						{{ $n := len .TreeNames}}
						{{ $l := Subtract $n 1}}
						{{range $i, $v := .TreeNames}}
							<div class="divider"> / </div>
							{{if eq $i $l}}
								<input type="text" id="file-name" value="{{$v}}" placeholder="Name your file..." required> <span class="octicon octicon-info poping up" data-content="{{$.i18n.Tr "repo.filename_help"}}" data-position="bottom center" data-variation="tiny"></span>
							{{else}}
								<span class="section"><a href="{{EscapePound $.BranchLink}}/{{EscapePound $v}}">{{$v}}</a></span>
							{{end}}
						{{end}}
						<input type="hidden" id="tree-name" name="tree_name" value="{{.TreeName}}" required>
					</div>
				</div>
			</div>
			<input type="hidden" name="is_new_file" value="{{.IsNewFile}}">
			<div class="field">
				<textarea id="edit-area" name="content" data-context="{{.RepoLink}}" autofocus>{{.FileContent}}</textarea required>
			</div>
			<div class="commit-form-wrapper">
				<img width="48" height="48" class="ui rounded image commit-form-avatar" src="{{.SignedUser.AvatarLink}}">
				<div class="commit-form">
					<h3>{{.i18n.Tr "repo.commit_changes"}}</h3>
					<div class="field">
						<input name="commit_summary" placeholder="{{if .IsNewFile}}{{.i18n.Tr "repo.add"}} '{{.TreeName}}/<filename>'{{else}}{{.i18n.Tr "repo.update"}} '{{.TreeName}}'{{end}}" value="{{.CommitSummary}}">
					</div>
					<div class="field">
						<textarea name="commit_message" placeholder="{{.i18n.Tr "repo.default_commit_message"}}">{{.CommitMessage}}</textarea>
					</div>
				</div>
				<button type="submit" class="ui green button">
					{{.i18n.Tr "repo.commit_changes"}}
				</button>
				<a class="ui button red" href="{{EscapePound $.BranchLink}}/{{EscapePound $.TreeName}}">{{.i18n.Tr "repo.cancel"}}</a>
			</div>
		</form>
	</div>
</div>
{{template "base/footer" .}}
